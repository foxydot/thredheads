/*!
 * WooCommerce Authorize.net AIM Gateway
 * Version 3.0
 *
 * Copyright (c) 2011-2014, SkyVerge, Inc.
 * Licensed under the GNU General Public License v3.0
 * http://www.gnu.org/licenses/gpl-3.0.html
 */jQuery(document).ready(function(e){"use strict";function r(t){if(t.is(".processing"))return!1;var n=e(".payment_method_authorize_net_aim"),r=[],s=n.find(".js-wc-payment-gateway-account-number").val(),u=n.find(".js-wc-payment-gateway-csc").val(),a=n.find(".js-wc-payment-gateway-card-exp-month").val(),f=n.find(".js-wc-payment-gateway-card-exp-year").val();s=s.replace(/-|\s/g,"");if(!s)r.push(authorize_net_aim_params.card_number_missing);else{(s.length<12||s.length>19)&&r.push(authorize_net_aim_params.card_number_length_invalid);/\D/.test(s)&&r.push(authorize_net_aim_params.card_number_digits_invalid);i(s)||r.push(authorize_net_aim_params.card_number_invalid)}var l=(new Date).getFullYear();(/\D/.test(a)||/\D/.test(f)||a>12||a<1||f<l||f>l+20)&&r.push(authorize_net_aim_params.card_exp_date_invalid);if("undefined"!=typeof u)if(!u)r.push(authorize_net_aim_params.cvv_missing);else{/\D/.test(u)&&r.push(authorize_net_aim_params.cvv_digits_invalid);(u.length<3||u.length>4)&&r.push(authorize_net_aim_params.cvv_length_invalid)}if(r.length>0){o(t,r);return!1}n.find(".js-wc-account-number").val(s);return!0}function i(e){var t=0;for(var n=0,r=e.length;n<r-1;n++){var i=parseInt(e.substr(r-(n+2),1)*(2-n%2));t+=i<10?i:i-9}return e.substr(r-1)==(10-t%10)%10}function s(t){if(t.is(".processing"))return!1;var n=e(".payment_method_authorize_net_aim_echeck"),r=[],i=n.find(".js-wc-payment-gateway-routing-number").val(),s=n.find(".js-wc-payment-gateway-account-number").val();if(!i)r.push(authorize_net_aim_params.routing_number_missing);else{9!=i.length&&r.push(authorize_net_aim_params.routing_number_length_invalid);/\D/.test(i)&&r.push(authorize_net_aim_params.routing_number_digits_invalid)}if(!s)r.push(authorize_net_aim_params.account_number_missing);else{(s.length<5||s.length>17)&&r.push(authorize_net_aim_params.account_number_length_invalid);/\D/.test(s)&&r.push(authorize_net_aim_params.account_number_invalid)}if(r.length>0){o(t,r);return!1}n.find(".js-wc-account-number").val(s);return!0}function o(t,n){e(".woocommerce-error, .woocommerce-message").remove();t.prepend('<ul class="woocommerce-error"><li>'+n.join("</li><li>")+"</li></ul>");t.removeClass("processing").unblock();t.find(".input-text, select").blur();e("html, body").animate({scrollTop:t.offset().top-100},1e3)}var t=e("form.checkout");if(t.length){t.bind("checkout_place_order_authorize_net_aim",function(){return r(e(this))});t.bind("checkout_place_order_authorize_net_aim_echeck",function(){return s(e(this))})}else{var n=e("#order_review input[name=payment_method]:checked").val();e("form#order_review").submit(function(){if("authorize_net_aim"==n)return r(e(this));if("authorize_net_aim_echeck"==n)return s(e(this))})}e("body").bind("updated_checkout",function(){e("img.js-wc-authorize-net-aim-echeck-account-help").click(function(){e(this).closest(".payment_method_authorize_net_aim_echeck").find(".sample-check").is(":visible")||e(this).closest(".payment_method_authorize_net_aim_echeck").find(".sample-check").slideDown()})})});